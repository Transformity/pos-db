-- Modify "transactionclosings" table
ALTER TABLE "transactionclosings" ALTER COLUMN "registernumber" SET NOT NULL, ALTER COLUMN "employeeid" SET NOT NULL, ALTER COLUMN "opendatetime" SET NOT NULL, ALTER COLUMN "closedatetime" SET NOT NULL, ALTER COLUMN "totaltax" SET NOT NULL, ALTER COLUMN "totaltax" DROP DEFAULT, ALTER COLUMN "totalsale" SET NOT NULL, ALTER COLUMN "totalsale" DROP DEFAULT, ALTER COLUMN "totalbottlefee" SET NOT NULL, ALTER COLUMN "totalbottlefee" DROP DEFAULT, ALTER COLUMN "totalenvironmentfee" SET NOT NULL, ALTER COLUMN "totalenvironmentfee" DROP DEFAULT, ALTER COLUMN "registeropeningbalance" DROP DEFAULT, ALTER COLUMN "registerclosingbalance" DROP DEFAULT, ALTER COLUMN "totalcreditcardsale" SET NOT NULL, ALTER COLUMN "totalcreditcardsale" DROP DEFAULT, ALTER COLUMN "totaldiscount" SET NOT NULL, ALTER COLUMN "totaldiscount" DROP DEFAULT, ALTER COLUMN "totalothersale" SET NOT NULL, ALTER COLUMN "totalothersale" DROP DEFAULT, ALTER COLUMN "totalchecksale" SET NOT NULL, ALTER COLUMN "totalchecksale" DROP DEFAULT, ALTER COLUMN "totalsubtotal" SET NOT NULL, ALTER COLUMN "totalsubtotal" DROP DEFAULT;
-- Modify "entity" table
ALTER TABLE "entity" ALTER COLUMN "name" DROP NOT NULL;
-- Modify "purchaseorders" table
ALTER TABLE "purchaseorders" ALTER COLUMN "name" TYPE character varying(2000), ALTER COLUMN "status" SET NOT NULL, ALTER COLUMN "invoiceid" TYPE character varying(255);
-- Set comment to table: "purchaseorders"
COMMENT ON TABLE "purchaseorders" IS 'metadata about purchase orders';
-- Modify "merchantdevices" table
ALTER TABLE "merchantdevices" ALTER COLUMN "deviceregistrationid" TYPE character varying(255), ALTER COLUMN "merchantname" TYPE character varying(255), ALTER COLUMN "merchantname" SET NOT NULL;
-- Create index "merchantdevices_merchantname_index" to table: "merchantdevices"
CREATE INDEX "merchantdevices_merchantname_index" ON "merchantdevices" ("merchantname");
-- Modify "employee" table
ALTER TABLE "employee" ALTER COLUMN "name" TYPE character varying(255), ALTER COLUMN "pin" TYPE character varying(255);
-- Modify "rainforestmerchants" table
ALTER TABLE "rainforestmerchants" ALTER COLUMN "name" TYPE character varying(255), ALTER COLUMN "merchantid" TYPE character varying(255), ALTER COLUMN "merchantid" SET NOT NULL, ALTER COLUMN "merchantapplicationid" TYPE character varying(255), ALTER COLUMN "merchantapplicationid" SET NOT NULL;
-- Modify "purchaseorderitems" table
ALTER TABLE "purchaseorderitems" ALTER COLUMN "unitsentered" SET NOT NULL, ALTER COLUMN "unitcost" SET NOT NULL, ALTER COLUMN "itemname" TYPE character varying(255), ALTER COLUMN "size" DROP DEFAULT, ALTER COLUMN "vendorsku" TYPE character varying(255), ALTER COLUMN "vendor" TYPE character varying(255), ALTER COLUMN "casecost" SET NOT NULL;
-- Modify "vendoritemprice" table
ALTER TABLE "vendoritemprice" ALTER COLUMN "catalog_date" TYPE character varying(7), ALTER COLUMN "last_modified" SET NOT NULL, ALTER COLUMN "buy_range" TYPE character varying(50), ALTER COLUMN "vendor_note" TYPE character varying(50), ALTER COLUMN "sku" TYPE character varying(255), ALTER COLUMN "vendor" TYPE character varying(255);
-- Create index "vendoritemprice_sku_vendor_index" to table: "vendoritemprice"
CREATE INDEX "vendoritemprice_sku_vendor_index" ON "vendoritemprice" ("sku", "vendor");
-- Create index "vendoritemprice_vendor_index" to table: "vendoritemprice"
CREATE INDEX "vendoritemprice_vendor_index" ON "vendoritemprice" ("vendor");
-- Modify "vendoritem" table
ALTER TABLE "vendoritem" ALTER COLUMN "last_modified" SET NOT NULL, ALTER COLUMN "size_unit" TYPE character varying(50), ALTER COLUMN "ttb" TYPE character varying(50), ALTER COLUMN "upc" TYPE character varying(50), ALTER COLUMN "product_style" TYPE character varying(100), ALTER COLUMN "product_subtype" TYPE character varying(100), ALTER COLUMN "product_type" TYPE character varying(100), ALTER COLUMN "product_name" TYPE character varying(355), ALTER COLUMN "product_name" SET NOT NULL, ALTER COLUMN "vendor_product_name" TYPE character varying(355), ALTER COLUMN "parent_producer" TYPE character varying(255), ALTER COLUMN "producer" TYPE character varying(255), ALTER COLUMN "product_line_id" TYPE character varying(255), ALTER COLUMN "sku" TYPE character varying(255), ALTER COLUMN "status" TYPE character varying(255), ALTER COLUMN "supplier" TYPE character varying(255), ALTER COLUMN "unit" TYPE character varying(255), ALTER COLUMN "vendor" TYPE character varying(255);
-- Create index "vendoritem_upc_index" to table: "vendoritem"
CREATE INDEX "vendoritem_upc_index" ON "vendoritem" ("upc");
-- Create index "vendoritem_vendor_index" to table: "vendoritem"
CREATE INDEX "vendoritem_vendor_index" ON "vendoritem" ("vendor");
-- Modify "item" table
ALTER TABLE "item" ALTER COLUMN "itemseqno" SET GENERATED BY DEFAULT SET START WITH 10418 SET INCREMENT BY 1, ALTER COLUMN "barcode" TYPE character varying(255), ALTER COLUMN "barcode2" TYPE character varying(255), ALTER COLUMN "caseqty" SET NOT NULL, ALTER COLUMN "changeby" TYPE character varying(255), ALTER COLUMN "changedate" SET NOT NULL, ALTER COLUMN "comments" TYPE character varying(255), ALTER COLUMN "cyaprsold" SET NOT NULL, ALTER COLUMN "cyaugsold" SET NOT NULL, ALTER COLUMN "cydecsold" SET NOT NULL, ALTER COLUMN "cyfebsold" SET NOT NULL, ALTER COLUMN "cyjansold" SET NOT NULL, ALTER COLUMN "cyjulsold" SET NOT NULL, ALTER COLUMN "cyjunsold" SET NOT NULL, ALTER COLUMN "cymarsold" SET NOT NULL, ALTER COLUMN "cymaysold" SET NOT NULL, ALTER COLUMN "cynovsold" SET NOT NULL, ALTER COLUMN "cyoctsold" SET NOT NULL, ALTER COLUMN "cysepsold" SET NOT NULL, ALTER COLUMN "cytotsold" SET NOT NULL, ALTER COLUMN "depositcode_tmp" TYPE character varying(255), ALTER COLUMN "depositmultiplier" SET NOT NULL, ALTER COLUMN "deptcode" TYPE character varying(255), ALTER COLUMN "description" TYPE character varying(255), ALTER COLUMN "envmultiplier" SET NOT NULL, ALTER COLUMN "isdiscountallowed" TYPE character varying(255), ALTER COLUMN "isdiscountallowed" SET NOT NULL, ALTER COLUMN "istaxed" TYPE character varying(255), ALTER COLUMN "last1cost" DROP DEFAULT, ALTER COLUMN "last1invoiceno" TYPE character varying(255), ALTER COLUMN "last1vendorcode" TYPE character varying(255), ALTER COLUMN "last2cost" DROP DEFAULT, ALTER COLUMN "last2invoiceno" TYPE character varying(255), ALTER COLUMN "last2vendorcode" TYPE character varying(255), ALTER COLUMN "lowbottleprice" DROP DEFAULT, ALTER COLUMN "outstandingpovendor" TYPE character varying(255), ALTER COLUMN "price" DROP DEFAULT, ALTER COLUMN "pricefuture" DROP DEFAULT, ALTER COLUMN "print_price" TYPE character varying(255), ALTER COLUMN "pyaprsold" SET NOT NULL, ALTER COLUMN "pyaprsold" DROP DEFAULT, ALTER COLUMN "pyaugsold" SET NOT NULL, ALTER COLUMN "pyaugsold" DROP DEFAULT, ALTER COLUMN "pydecsold" SET NOT NULL, ALTER COLUMN "pydecsold" DROP DEFAULT, ALTER COLUMN "pyfebsold" SET NOT NULL, ALTER COLUMN "pyfebsold" DROP DEFAULT, ALTER COLUMN "pyjansold" SET NOT NULL, ALTER COLUMN "pyjansold" DROP DEFAULT, ALTER COLUMN "pyjulsold" SET NOT NULL, ALTER COLUMN "pyjulsold" DROP DEFAULT, ALTER COLUMN "pyjunsold" SET NOT NULL, ALTER COLUMN "pyjunsold" DROP DEFAULT, ALTER COLUMN "pymarsold" SET NOT NULL, ALTER COLUMN "pymarsold" DROP DEFAULT, ALTER COLUMN "pymaysold" SET NOT NULL, ALTER COLUMN "pymaysold" DROP DEFAULT, ALTER COLUMN "pynovsold" SET NOT NULL, ALTER COLUMN "pynovsold" DROP DEFAULT, ALTER COLUMN "pyoctsold" SET NOT NULL, ALTER COLUMN "pyoctsold" DROP DEFAULT, ALTER COLUMN "pysepsold" SET NOT NULL, ALTER COLUMN "pysepsold" DROP DEFAULT, ALTER COLUMN "pytotsold" DROP DEFAULT, ALTER COLUMN "qtyonhand" SET NOT NULL, ALTER COLUMN "subparentitembarcode_tmp" TYPE character varying(255), ALTER COLUMN "subqty" SET NOT NULL, ALTER COLUMN "suggestedretail" DROP DEFAULT;
-- Modify "vendor" table
ALTER TABLE "vendor" ALTER COLUMN "name" TYPE character varying(255), ALTER COLUMN "displayname" TYPE character varying(255), ALTER COLUMN "displayname" SET NOT NULL;
-- Modify "itemvendoritemmapping" table
ALTER TABLE "itemvendoritemmapping" ALTER COLUMN "sku" TYPE character varying(255), ALTER COLUMN "vendor" TYPE character varying(255), ADD CONSTRAINT "itemvendoritemmapping_item_itemseqno_fk" FOREIGN KEY ("itemid") REFERENCES "item" ("itemseqno") ON UPDATE NO ACTION ON DELETE NO ACTION, ADD CONSTRAINT "itemvendoritemmapping_vendor_name_fk" FOREIGN KEY ("vendor") REFERENCES "vendor" ("name") ON UPDATE NO ACTION ON DELETE NO ACTION;
-- Modify "department" table
ALTER TABLE "department" ALTER COLUMN "name" TYPE character varying(255), ALTER COLUMN "tax" SET NOT NULL, ALTER COLUMN "tax" DROP DEFAULT, ALTER COLUMN "bottledeposit" SET NOT NULL, ALTER COLUMN "bottledeposit" DROP DEFAULT, ALTER COLUMN "environmentfee" SET NOT NULL, ALTER COLUMN "environmentfee" DROP DEFAULT;
-- Modify "transactions" table
ALTER TABLE "transactions" ALTER COLUMN "amountreceived" DROP DEFAULT, ALTER COLUMN "transactiontotal" DROP DEFAULT, ALTER COLUMN "paymentform" TYPE character varying(255), ALTER COLUMN "registernumber" SET NOT NULL, ALTER COLUMN "creditcardamountreceived" SET NOT NULL, ALTER COLUMN "creditcardamountreceived" DROP DEFAULT, ALTER COLUMN "checkamountreceived" SET NOT NULL, ALTER COLUMN "checkamountreceived" DROP DEFAULT, ALTER COLUMN "otheramountreceived" SET NOT NULL, ALTER COLUMN "otheramountreceived" DROP DEFAULT, ALTER COLUMN "isvoided" SET NOT NULL, ALTER COLUMN "payinconfigid" TYPE character varying(255);
-- Create index "transactions_closingsid_index" to table: "transactions"
CREATE INDEX "transactions_closingsid_index" ON "transactions" ("closingsid");
-- Modify "transactionitems" table
ALTER TABLE "transactionitems" DROP CONSTRAINT "transactionitems_item_itemseqno_fk", DROP CONSTRAINT "transactionitems_transactions_id_fk", ALTER COLUMN "quantity" SET NOT NULL, ALTER COLUMN "littleroosteritemid" SET NOT NULL, ALTER COLUMN "price" SET NOT NULL, ALTER COLUMN "price" DROP DEFAULT, ALTER COLUMN "tax" SET NOT NULL, ALTER COLUMN "tax" DROP DEFAULT, ALTER COLUMN "upccode" TYPE character varying(255), ALTER COLUMN "name" TYPE character varying(255), ALTER COLUMN "name" SET NOT NULL, ALTER COLUMN "totalprice" SET NOT NULL, ALTER COLUMN "totalprice" DROP DEFAULT, ALTER COLUMN "transactionfk" SET NOT NULL, ALTER COLUMN "discount" SET NOT NULL, ALTER COLUMN "discount" DROP DEFAULT, ALTER COLUMN "bottledeposit" SET NOT NULL, ALTER COLUMN "bottledeposit" DROP DEFAULT, ALTER COLUMN "environmentfee" SET NOT NULL, ALTER COLUMN "environmentfee" DROP DEFAULT, ALTER COLUMN "department" TYPE character varying(255), ALTER COLUMN "department" SET NOT NULL, ADD CONSTRAINT "transactionsmetadata_departments_name_fk" FOREIGN KEY ("department") REFERENCES "department" ("name") ON UPDATE NO ACTION ON DELETE NO ACTION, ADD CONSTRAINT "transactionsmetadata_transactions_id_fk" FOREIGN KEY ("transactionfk") REFERENCES "transactions" ("id") ON UPDATE NO ACTION ON DELETE CASCADE;
